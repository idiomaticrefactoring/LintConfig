{
  "description": "[Status: stable] [Name: function-call-in-default-argument] [Message: Do not perform function call <code>{name}</code> in argument defaults; instead, perform the call within the function, or read the default from a module-level singleton variable] What it does Checks for function calls in default function arguments. Why is this bad? Any function call that's used in a default argument will only be performed once, at definition time. The returned value will then be reused by all calls to the function, which can lead to unexpected behaviour. Parameters with immutable type annotations will be ignored by this rule. Those whose default arguments are NewType calls where the original type is immutable are also ignored. Calls and types outside of the standard library can be marked as an exception to this rule with the lint.flake8-bugbear.extend-immutable-calls configuration option. Example def create_list() -> list[int]: return [1, 2, 3] def mutable_default(arg: list[int] = create_list()) -> list[int]: arg.append(4) return arg Use instead: def better(arg: list[int] | None = None) -> list[int]: if arg is None: arg = create_list() arg.append(4) return arg If the use of a singleton is intentional, assign the result call to a module-level variable, and use that variable in the default argument: ERROR = ValueError(\"Hosts weren't successfully added\") def add_host(error: Exception = ERROR) -> None: ...",
  "option": {
    "lint.flake8-bugbear.extend-immutable-calls": {
      "option_description": "Additional callable functions to consider \"immutable\" when evaluating, e.g., the\nfunction-call-in-default-argument rule (B008) or function-call-in-dataclass-defaults\nrule (RUF009).\n\nExpects to receive a list of fully-qualified names (e.g., fastapi.Query, rather than\nQuery).\n\n\n\nExample usage:\n\npyproject.tomlruff.toml\n\n\n[tool.ruff.lint.flake8-bugbear]\n# Allow default arguments like, e.g., `data: List[str] = fastapi.Query(None)`.\nextend-immutable-calls = [\"fastapi.Depends\", \"fastapi.Query\"]\n\n\n\n[lint.flake8-bugbear]\n# Allow default arguments like, e.g., `data: List[str] = fastapi.Query(None)`.\nextend-immutable-calls = [\"fastapi.Depends\", \"fastapi.Query\"]",
      "option_data_type": "list[str]",
      "default_value": "[]",
      "option_values": {
        "valuelist": []
      }
    }
  }
}