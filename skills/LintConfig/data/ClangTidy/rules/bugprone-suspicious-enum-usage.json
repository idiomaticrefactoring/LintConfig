{
    "bugprone-suspicious-enum-usage": {
        "description": "Description\n\nThe checker detects various cases when an enum is probably misused\n(as a bitmask).\n\nWhen “ADD” or “bitwise OR” is used between two enum which come\nfrom different types and these types value ranges are not disjoint.\n\nThe following cases will be investigated only using\nStrictMode\n. We\nregard the enum as a (suspicious)\nbitmask if the three conditions below are true at the same time:\n\nat most half of the elements of the enum are non pow-of-2 numbers (because of\nshort enumerations)\nthere is another non pow-of-2 number than the enum constant representing all\nchoices (the result “bitwise OR” operation of all enum elements)\nenum type variable/enumconstant is used as an argument of a\n+\nor “bitwise\nOR” operator\n\nSo whenever the non pow-of-2 element is used as a bitmask element we diagnose a\nmisuse and give a warning.\n\nInvestigating the right hand side of\n+=\nand\n|=\noperator.\nCheck only the enum value side of a\n|\nand\n+\noperator if one of\nthem is not enum val.\nCheck both side of\n|\nor\n+\noperator where the enum values are from\nthe same enum type.\n\nExamples:\n\nenum\n{\nA\n,\nB\n,\nC\n};\nenum\n{\nD\n,\nE\n,\nF\n=\n5\n};\nenum\n{\nG\n=\n10\n,\nH\n=\n11\n,\nI\n=\n12\n};\nunsigned\nflag\n;\nflag\n=\nA\n|\nH\n;\n// OK, disjoint value intervals in the enum types ->probably good use.\nflag\n=\nB\n|\nF\n;\n// Warning, have common values so they are probably misused.\n// Case 2:\nenum\nBitmask\n{\nA\n=\n0\n,\nB\n=\n1\n,\nC\n=\n2\n,\nD\n=\n4\n,\nE\n=\n8\n,\nF\n=\n16\n,\nG\n=\n31\n// OK, real bitmask.\n};\nenum\nAlmostbitmask\n{\nAA\n=\n0\n,\nBB\n=\n1\n,\nCC\n=\n2\n,\nDD\n=\n4\n,\nEE\n=\n8\n,\nFF\n=\n16\n,\nGG\n// Problem, forgot to initialize.\n};\nunsigned\nflag\n=\n0\n;\nflag\n|=\nE\n;\n// OK.\nflag\n|=\nEE\n;\n// Warning at the decl, and note that it was used here as a bitmask.",
        "option": "Static analysis (Clang-Tidy) options are configured via .clang-tidy file.\n\nOptions\nStrictMode\nDefault value: 0.\nWhen non-null the suspicious bitmask usage will be investigated additionally\nto the different enum usage check."
    }
}