{
    "bugprone-unsafe-functions": {
        "description": "Description\n\nChecks for functions that have safer, more secure replacements available, or\nare considered deprecated due to design flaws.\nThe check heavily relies on the functions from the\nAnnex K.\n“Bounds-checking interfaces” of C11.\n\nThe check implements the following rules from the CERT C Coding Standard:\nRecommendation\nMSC24-C. Do not use deprecated or obsolescent functions\n.\nRule\nMSC33-C. Do not pass invalid data to the asctime() function\n.\n\ncert-msc24-c\nand\ncert-msc33-c\nredirect here as aliases of this check.\n\nUnsafe functions\nThe following functions are reported if\nReportDefaultFunctions\nis enabled.\nIf\nAnnex K.\nis available, a replacement from\nAnnex K.\nis suggested for the\nfollowing functions:\nasctime\n,\nasctime_r\n,\nbsearch\n,\nctime\n,\nfopen\n,\nfprintf\n,\nfreopen\n,\nfscanf\n,\nfwprintf\n,\nfwscanf\n,\ngetenv\n,\ngets\n,\ngmtime\n,\nlocaltime\n,\nmbsrtowcs\n,\nmbstowcs\n,\nmemcpy\n,\nmemmove\n,\nmemset\n,\nprintf\n,\nqsort\n,\nscanf\n,\nsnprintf\n,\nsprintf\n,\nsscanf\n,\nstrcat\n,\nstrcpy\n,\nstrerror\n,\nstrlen\n,\nstrncat\n,\nstrncpy\n,\nstrtok\n,\nswprintf\n,\nswscanf\n,\nvfprintf\n,\nvfscanf\n,\nvfwprintf\n,\nvfwscanf\n,\nvprintf\n,\nvscanf\n,\nvsnprintf\n,\nvsprintf\n,\nvsscanf\n,\nvswprintf\n,\nvswscanf\n,\nvwprintf\n,\nvwscanf\n,\nwcrtomb\n,\nwcscat\n,\nwcscpy\n,\nwcslen\n,\nwcsncat\n,\nwcsncpy\n,\nwcsrtombs\n,\nwcstok\n,\nwcstombs\n,\nwctomb\n,\nwmemcpy\n,\nwmemmove\n,\nwprintf\n,\nwscanf\n.\nIf\nAnnex K.\nis not available, replacements are suggested only for the\nfollowing functions from the previous list:\nasctime\n,\nasctime_r\n, suggested replacement:\nstrftime\ngets\n, suggested replacement:\nfgets\nThe following functions are always checked, regardless of\nAnnex K\navailability:\nrewind\n, suggested replacement:\nfseek\nsetbuf\n, suggested replacement:\nsetvbuf\nstd::get_temporary_buffer\n, suggested replacement: “plain” allocation\nwith\noperator\nnew[]\nIf\nReportMoreUnsafeFunctions\nis enabled,\nthe following functions are also checked:\nbcmp\n, suggested replacement:\nmemcmp\nbcopy\n, suggested replacement:\nmemcpy_s\nif\nAnnex K\nis available,\nor\nmemcpy\nbzero\n, suggested replacement:\nmemset_s\nif\nAnnex K\nis available,\nor\nmemset\ngetpw\n, suggested replacement:\ngetpwuid\nvfork\n, suggested replacement:\nposix_spawn\nAlthough mentioned in the associated CERT rules, the following functions are\nignored\nby the check:\natof\n,\natoi\n,\natol\n,\natoll\n,\ntmpfile\n.\nThe availability of\nAnnex K\nis determined based on the following macros:\n__STDC_LIB_EXT1__\n: feature macro, which indicates the presence of\nAnnex K. “Bounds-checking interfaces”\nin the library implementation\n__STDC_WANT_LIB_EXT1__\n: user-defined macro, which indicates that the\nuser requests the functions from\nAnnex K.\nto be defined.\nBoth macros have to be defined to suggest replacement functions from\nAnnex K.\n__STDC_LIB_EXT1__\nis defined by the library implementation, and\n__STDC_WANT_LIB_EXT1__\nmust be defined to\n1\nby the user\nbefore\nincluding any system headers.",
        "option": "Static analysis (Clang-Tidy) options are configured via .clang-tidy file.\n\nCustom functions\nThe option\nCustomFunctions\nallows the user to define custom functions\nto be checked. The format is the following, without newlines:\nbugprone\n-\nunsafe\n-\nfunctions\n.\nCustomFunctions\n=\n\"\nfunctionRegex1\n[,\nreplacement1\n[,\nreason1\n]];\nfunctionRegex2\n[,\nreplacement2\n[,\nreason2\n]];\n...\n\"\nThe functions are matched using POSIX extended regular expressions.\n(Note: The regular expressions do not support negative\n(?!)\nmatches.)\nThe\nreason\nis optional and is used to provide additional information about\nthe reasoning behind the replacement. The default reason is\nis marked as unsafe\n.\nIf\nreplacement\nis empty, the default text\nit should not be used\nwill be\nshown instead of the suggestion for a replacement.\nIf the\nreason\nstarts with the character\n>\n, the reason becomes fully\ncustom. The default suffix is disabled even if a\nreplacement\nis present,\nand only the reason message is shown after the matched function, to allow\nbetter control over the suggestions. (The starting\n>\nand whitespace\ndirectly after it are trimmed from the message.)\nAs an example, the following configuration matches only the function\noriginal\nin the default namespace. A similar diagnostic can also be printed\nusing a fully custom reason.\n// bugprone-unsafe-functions.CustomFunctions:\n//   ^original$, replacement, is deprecated;\n// Using the fully custom message syntax:\n//   ^suspicious$,,> should be avoided if possible.\noriginal\n();\n// warning: function 'original' is deprecated; 'replacement' should be used instead.\nsuspicious\n();\n// warning: function 'suspicious' should be avoided if possible.\n::\nstd\n::\noriginal\n();\n// no-warning\noriginal_function\n();\n// no-warning\nIf the regular expression contains the character\n:\n, it is matched against\nthe qualified name (i.e.\nstd::original\n), otherwise the regex is matched\nagainst the unqualified name (\noriginal\n). If the regular expression starts\nwith\n::\n(or\n^::\n), it is matched against the fully qualified name\n(\n::std::original\n).\nOne of the use cases for fully custom messages is suggesting compiler options\nand warning flags:\n// bugprone-unsafe-functions.CustomFunctions:\n//   ^memcpy$,,>is recommended to have compiler hardening using '_FORTIFY_SOURCE';\n//   ^printf$,,>is recommended to have the '-Werror=format-security' compiler warning flag;\nmemcpy\n(\ndest\n,\nsrc\n,\n999'999\n);\n// warning: function 'memcpy' is recommended to have compiler hardening using '_FORTIFY_SOURCE'\nprintf\n(\nraw_str\n);\n// warning: function 'printf' is recommended to have the '-Werror=format-security' compiler warning flag\nNote\nFully qualified names can contain template parameters on certain C++ classes,\nbut not on C++ functions. Type aliases are resolved before matching.\nAs an example, the member function\nopen\nin the class\nstd::ifstream\nhas a fully qualified name of\n::std::basic_ifstream<char>::open\n.\nThe example could also be matched with the regex\n::std::basic_ifstream<[^>]*>::open\n, which matches all potential template\nparameters, but does not match nested template classes.\n\nOptions\nReportMoreUnsafeFunctions\nWhen\ntrue\n, additional functions from widely used APIs (such as POSIX) are\nadded to the list of reported functions.\nSee the main documentation of the check for the complete list as to what\nthis option enables.\nDefault is\ntrue\n.\nReportDefaultFunctions\nWhen\ntrue\n, the check reports the default set of functions.\nConsider changing the setting to false if you only want to see custom\nfunctions matched via\ncustom functions\n.\nDefault is\ntrue\n.\nCustomFunctions\nA semicolon-separated list of custom functions to be matched. A matched\nfunction contains a regular expression, an optional name of the replacement\nfunction, and an optional reason, separated by comma. For more information,\nsee\nCustom functions\n.\n\nExamples\n#ifndef __STDC_LIB_EXT1__\n#error \"Annex K is not supported by the current standard library implementation.\"\n#endif\n#define __STDC_WANT_LIB_EXT1__ 1\n#include\n<string.h>\n// Defines functions from Annex K.\n#include\n<stdio.h>\nenum\n{\nBUFSIZE\n=\n32\n};\nvoid\nUnsafe\n(\nconst\nchar\n*\nMsg\n)\n{\nstatic\nconst\nchar\nPrefix\n[]\n=\n\"Error: \"\n;\nstatic\nconst\nchar\nSuffix\n[]\n=\n\"\n\\n\n\"\n;\nchar\nBuf\n[\nBUFSIZE\n]\n=\n{\n0\n};\nstrcpy\n(\nBuf\n,\nPrefix\n);\n// warning: function 'strcpy' is not bounds-checking; 'strcpy_s' should be used instead.\nstrcat\n(\nBuf\n,\nMsg\n);\n// warning: function 'strcat' is not bounds-checking; 'strcat_s' should be used instead.\nstrcat\n(\nBuf\n,\nSuffix\n);\n// warning: function 'strcat' is not bounds-checking; 'strcat_s' should be used instead.\nif\n(\nfputs\n(\nbuf\n,\nstderr\n)\n<\n0\n)\n{\n// error handling\nreturn\n;\n}\n}\nvoid\nUsingSafeFunctions\n(\nconst\nchar\n*\nMsg\n)\n{\nstatic\nconst\nchar\nPrefix\n[]\n=\n\"Error: \"\n;\nstatic\nconst\nchar\nSuffix\n[]\n=\n\"\n\\n\n\"\n;\nchar\nBuf\n[\nBUFSIZE\n]\n=\n{\n0\n};\nif\n(\nstrcpy_s\n(\nBuf\n,\nBUFSIZE\n,\nPrefix\n)\n!=\n0\n)\n{\n// error handling\nreturn\n;\n}\nif\n(\nstrcat_s\n(\nBuf\n,\nBUFSIZE\n,\nMsg\n)\n!=\n0\n)\n{\n// error handling\nreturn\n;\n}\nif\n(\nstrcat_s\n(\nBuf\n,\nBUFSIZE\n,\nSuffix\n)\n!=\n0\n)\n{\n// error handling\nreturn\n;\n}\nif\n(\nfputs\n(\nBuf\n,\nstderr\n)\n<\n0\n)\n{\n// error handling\nreturn\n;\n}\n}"
    }
}