{
  "name": "misc-definitions-in-headers",
  "meta": {
    "url": "https://clang.llvm.org/extra/clang-tidy/checks/misc/definitions-in-headers.html",
    "fixable": true
  },
  "content": {
    "introduction": "Finds non-extern non-inline function and variable definitions in header files,\nwhich can lead to potential ODR violations in case these headers are included\nfrom multiple translation units.\n\n// Foo.h\n\n\nint\n \na\n \n=\n \n1\n;\n \n// Warning: variable definition.\n\n\nextern\n \nint\n \nd\n;\n \n// OK: extern variable.\n\n\n\nnamespace\n \nN\n \n{\n\n\n  \nint\n \ne\n \n=\n \n2\n;\n \n// Warning: variable definition.\n\n\n}\n\n\n\n// Warning: variable definition.\n\n\nconst\n \nchar\n*\n \nstr\n \n=\n \n\"foo\"\n;\n\n\n\n// OK: internal linkage variable definitions are ignored for now.\n\n\n// Although these might also cause ODR violations, we can be less certain and\n\n\n// should try to keep the false-positive rate down.\n\n\nstatic\n \nint\n \nb\n \n=\n \n1\n;\n\n\nconst\n \nint\n \nc\n \n=\n \n1\n;\n\n\nconst\n \nchar\n*\n \nconst\n \nstr2\n \n=\n \n\"foo\"\n;\n\n\nconstexpr\n \nint\n \nk\n \n=\n \n1\n;\n\n\nnamespace\n \n{\n \nint\n \nx\n \n=\n \n1\n;\n \n}\n\n\n\n// Warning: function definition.\n\n\nint\n \ng\n()\n \n{\n\n\n  \nreturn\n \n1\n;\n\n\n}\n\n\n\n// OK: inline function definition is allowed to be defined multiple times.\n\n\ninline\n \nint\n \ne\n()\n \n{\n\n\n  \nreturn\n \n1\n;\n\n\n}\n\n\n\nclass\n \nA\n \n{\n\n\npublic\n:\n\n\n  \nint\n \nf1\n()\n \n{\n \nreturn\n \n1\n;\n \n}\n \n// OK: implicitly inline member function definition is allowed.\n\n\n  \nint\n \nf2\n();\n\n\n\n  \nstatic\n \nint\n \nd\n;\n\n\n};\n\n\n\n// Warning: not an inline member function definition.\n\n\nint\n \nA::f2\n()\n \n{\n \nreturn\n \n1\n;\n \n}\n\n\n\n// OK: class static data member declaration is allowed.\n\n\nint\n \nA\n::\nd\n \n=\n \n1\n;\n\n\n\n// OK: function template is allowed.\n\n\ntemplate\n<\ntypename\n \nT\n>\n\n\nT\n \nf3\n()\n \n{\n\n\n  \nT\n \na\n \n=\n \n1\n;\n\n\n  \nreturn\n \na\n;\n\n\n}\n\n\n\n// Warning: full specialization of a function template is not allowed.\n\n\ntemplate\n \n<>\n\n\nint\n \nf3\n()\n \n{\n\n\n  \nint\n \na\n \n=\n \n1\n;\n\n\n  \nreturn\n \na\n;\n\n\n}\n\n\n\ntemplate\n \n<\ntypename\n \nT\n>\n\n\nstruct\n \nB\n \n{\n\n\n  \nvoid\n \nf1\n();\n\n\n};\n\n\n\n// OK: member function definition of a class template is allowed.\n\n\ntemplate\n \n<\ntypename\n \nT\n>\n\n\nvoid\n \nB\n<\nT\n>::\nf1\n()\n \n{}\n\n\n\nclass\n \nCE\n \n{\n\n\n  \nconstexpr\n \nstatic\n \nint\n \ni\n \n=\n \n5\n;\n \n// OK: inline variable definition.\n\n\n};\n\n\n\ninline\n \nint\n \ni\n \n=\n \n5\n;\n \n// OK: inline variable definition.\n\n\n\nconstexpr\n \nint\n \nf10\n()\n \n{\n \nreturn\n \n0\n;\n \n}\n \n// OK: constexpr function implies inline.\n\n\n\n// OK: C++14 variable templates are inline.\n\n\ntemplate\n \n<\nclass\n \nT\n>\n\n\nconstexpr\n \nT\n \npi\n \n=\n \nT\n(\n3.1415926L\n);\n\nWhen \nclang-tidy\n is invoked with the \nâfix-notes\n option, this check\nprovides fixes that automatically add the \ninline\n keyword to discovered\nfunctions. Please note that the addition of the \ninline\n keyword to variables\nis not currently supported by this check.",
    "configurations": []
  }
}