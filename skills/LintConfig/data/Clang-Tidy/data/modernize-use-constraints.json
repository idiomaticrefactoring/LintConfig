{
  "name": "modernize-use-constraints",
  "meta": {
    "url": "https://clang.llvm.org/extra/clang-tidy/checks/modernize/use-constraints.html",
    "fixable": true
  },
  "content": {
    "introduction": "Replace \nstd::enable_if\n with C++20 requires clauses.\n\nstd::enable_if\n is a SFINAE mechanism for selecting the desired function or\nclass template based on type traits or other requirements. \nenable_if\n\nchanges the meta-arity of the template, and has other\n\nadverse side effects\n\nin the code. C++20 introduces concepts and constraints as a cleaner language\nprovided solution to achieve the same outcome.\n\nThis check finds some common \nstd::enable_if\n patterns that can be replaced\nby C++20 requires clauses. The tool can replace some of these patterns\nautomatically, otherwise, the tool will emit a diagnostic without a\nreplacement. The tool can detect the following \nstd::enable_if\n patterns\n\nstd::enable_if\n in the return type of a function\n\n\nstd::enable_if\n as the trailing template parameter for function templates\n\nOther uses, for example, in class templates for function parameters, are not\ncurrently supported by this tool. Other variants such as \nboost::enable_if\n\nare not currently supported by this tool.\n\nBelow are some examples of code using \nstd::enable_if\n.\n\n// enable_if in function return type\n\n\ntemplate\n \n<\ntypename\n \nT\n>\n\n\nstd\n::\nenable_if_t\n<\nT\n::\nsome_trait\n,\n \nint\n>\n \nonly_if_t_has_the_trait\n()\n \n{\n \n...\n \n}\n\n\n\n// enable_if in the trailing template parameter\n\n\ntemplate\n \n<\ntypename\n \nT\n,\n \nstd\n::\nenable_if_t\n<\nT\n::\nsome_trait\n,\n \nint\n>\n \n=\n \n0\n>\n\n\nvoid\n \nanother_version\n()\n \n{\n \n...\n \n}\n\n\n\ntemplate\n \n<\ntypename\n \nT\n>\n\n\ntypename\n \nstd\n::\nenable_if\n<\nT\n::\nsome_value\n,\n \nObj\n>::\ntype\n \nexisting_constraint\n()\n \nrequires\n \n(\nT\n::\nanother_value\n)\n \n{\n\n\n  \nreturn\n \nObj\n{};\n\n\n}\n\n\n\ntemplate\n \n<\ntypename\n \nT\n,\n \nstd\n::\nenable_if_t\n<\nT\n::\nsome_trait\n,\n \nint\n>\n \n=\n \n0\n>\n\n\nstruct\n \nmy_class\n \n{};\n\nThe tool will replace the above code with,\n\n// warning: use C++20 requires constraints instead of enable_if [modernize-use-constraints]\n\n\ntemplate\n \n<\ntypename\n \nT\n>\n\n\nint\n \nonly_if_t_has_the_trait\n()\n \nrequires\n \nT\n::\nsome_trait\n \n{\n \n...\n \n}\n\n\n\n// warning: use C++20 requires constraints instead of enable_if [modernize-use-constraints]\n\n\ntemplate\n \n<\ntypename\n \nT\n>\n\n\nvoid\n \nanother_version\n()\n \nrequires\n \nT\n::\nsome_trait\n \n{\n \n...\n \n}\n\n\n\n// The tool will emit a diagnostic for the following, but will\n\n\n// not attempt to replace the code.\n\n\n// warning: use C++20 requires constraints instead of enable_if [modernize-use-constraints]\n\n\ntemplate\n \n<\ntypename\n \nT\n>\n\n\ntypename\n \nstd\n::\nenable_if\n<\nT\n::\nsome_value\n,\n \nObj\n>::\ntype\n \nexisting_constraint\n()\n \nrequires\n \n(\nT\n::\nanother_value\n)\n \n{\n\n\n  \nreturn\n \nObj\n{};\n\n\n}\n\n\n\n// The tool will not emit a diagnostic or attempt to replace the code.\n\n\ntemplate\n \n<\ntypename\n \nT\n,\n \nstd\n::\nenable_if_t\n<\nT\n::\nsome_trait\n,\n \nint\n>\n \n=\n \n0\n>\n\n\nstruct\n \nmy_class\n \n{};\n\nNote\n\n\nSystem headers are not analyzed by this check.",
    "configurations": []
  }
}