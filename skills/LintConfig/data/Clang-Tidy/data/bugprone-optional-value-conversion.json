{
  "name": "bugprone-optional-value-conversion",
  "meta": {
    "url": "https://clang.llvm.org/extra/clang-tidy/checks/bugprone/optional-value-conversion.html",
    "fixable": true
  },
  "content": {
    "introduction": "Detects potentially unintentional and redundant conversions where a value is\nextracted from an optional-like type and then used to create a new instance of\nthe same optional-like type.\n\nThese conversions might be the result of developer oversight, leftovers from\ncode refactoring, or other situations that could lead to unintended exceptions\nor cases where the resulting optional is always initialized, which might be\nunexpected behavior.\n\nTo illustrate, consider the following problematic code snippet:\n\n#include\n \n<optional>\n\n\n\nvoid\n \nprint\n(\nstd\n::\noptional\n<\nint\n>\n);\n\n\n\nint\n \nmain\n()\n\n\n{\n\n\n  \nstd\n::\noptional\n<\nint\n>\n \nopt\n;\n\n\n  \n// ...\n\n\n\n  \n// Unintentional conversion from std::optional<int> to int and back to\n\n\n  \n// std::optional<int>:\n\n\n  \nprint\n(\nopt\n.\nvalue\n());\n\n\n\n  \n// ...\n\n\n}\n\nA better approach would be to directly pass \nopt\n to the \nprint\n function\nwithout extracting its value:\n\n#include\n \n<optional>\n\n\n\nvoid\n \nprint\n(\nstd\n::\noptional\n<\nint\n>\n);\n\n\n\nint\n \nmain\n()\n\n\n{\n\n\n  \nstd\n::\noptional\n<\nint\n>\n \nopt\n;\n\n\n  \n// ...\n\n\n\n  \n// Proposed code: Directly pass the std::optional<int> to the print\n\n\n  \n// function.\n\n\n  \nprint\n(\nopt\n);\n\n\n\n  \n// ...\n\n\n}\n\nBy passing \nopt\n directly to the print function, unnecessary conversions are\navoided, and potential unintended behavior or exceptions are minimized.\n\nValue extraction using \noperator\n \n*\n is matched by default.\nThe support for non-standard optional types such as \nboost::optional\n or\n\nabsl::optional\n may be limited.\n\nOptions:\nÂ¶\n\n\n\n\n\n\nOptionalTypes\nÂ¶\n\n\nSemicolon-separated list of (fully qualified) optional type names or regular\nexpressions that match the optional types.\nDefault value is \n::std::optional;::absl::optional;::boost::optional\n.\n\n\n\n\n\n\n\n\nValueMethods\nÂ¶\n\n\nSemicolon-separated list of (fully qualified) method names or regular\nexpressions that match the methods.\nDefault value is \n::value$;::get$\n.",
    "configurations": []
  }
}