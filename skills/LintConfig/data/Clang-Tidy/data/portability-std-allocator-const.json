{
  "name": "portability-std-allocator-const",
  "meta": {
    "url": "https://clang.llvm.org/extra/clang-tidy/checks/portability/std-allocator-const.html",
    "fixable": false
  },
  "content": {
    "introduction": "Report use of \nstd::vector<const\n \nT>\n (and similar containers of const\nelements). These are not allowed in standard C++, and should usually be\n\nstd::vector<T>\n instead.â\n\nPer C++ \n[allocator.requirements.general]\n: âT is any cv-unqualified object\ntypeâ, \nstd::allocator<const\n \nT>\n is undefined. Many standard containers use\n\nstd::allocator\n by default and therefore their \nconst\n \nT\n instantiations\nare undefined.\n\nlibc++ defines \nstd::allocator<const\n \nT>\n as an extension which will be\nremoved in the future.\n\nlibstdc++ and MSVC do not support \nstd::allocator<const\n \nT>\n:\n\n// libstdc++ has a better diagnostic since https://gcc.gnu.org/bugzilla/show_bug.cgi?id=48101\n\n\nstd\n::\ndeque\n<\nconst\n \nint\n>\n \ndeque\n;\n \n// error: static assertion failed: std::deque must have a non-const, non-volatile value_type\n\n\nstd\n::\nset\n<\nconst\n \nint\n>\n \nset\n;\n \n// error: static assertion failed: std::set must have a non-const, non-volatile value_type\n\n\nstd\n::\nvector\n<\nint\n*\n \nconst\n>\n \nvector\n;\n \n// error: static assertion failed: std::vector must have a non-const, non-volatile value_type\n\n\n\n// MSVC\n\n\n// error C2338: static_assert failed: 'The C++ Standard forbids containers of const elements because allocator<const T> is ill-formed.'\n\nCode bases only compiled with libc++ may accrue such undefined usage. This\ncheck finds such code and prevents backsliding while clean-up is ongoing.",
    "configurations": []
  }
}