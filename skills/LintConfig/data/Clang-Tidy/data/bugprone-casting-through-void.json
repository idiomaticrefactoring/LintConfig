{
  "name": "bugprone-casting-through-void",
  "meta": {
    "url": "https://clang.llvm.org/extra/clang-tidy/checks/bugprone/casting-through-void.html",
    "fixable": false
  },
  "content": {
    "introduction": "Detects unsafe or redundant two-step casting operations involving \nvoid*\n,\nwhich is equivalent to \nreinterpret_cast\n as per the\n\nC++ Standard\n.\n\nTwo-step type conversions via \nvoid*\n are discouraged for several reasons.\n\nThey obscure code and impede its understandability, complicating maintenance.\n\n\nThese conversions bypass valuable compiler support, erasing warnings related\nto pointer alignment. It may violate strict aliasing rule and leading to\nundefined behavior.\n\n\nIn scenarios involving multiple inheritance, ambiguity and unexpected\noutcomes can arise due to the loss of type information, posing runtime\nissues.\n\nIn summary, avoiding two-step type conversions through \nvoid*\n ensures\nclearer code, maintains essential compiler warnings, and prevents ambiguity\nand potential runtime errors, particularly in complex inheritance scenarios.\nIf such a cast is wanted, it shall be done via \nreinterpret_cast\n,\nto express the intent more clearly.\n\nNote: it is expected that, after applying the suggested fix and using\n\nreinterpret_cast\n, the check\n\ncppcoreguidelines-pro-type-reinterpret-cast\n will emit a warning.\nThis is intentional: \nreinterpret_cast\n is a dangerous operation that can\neasily break the strict aliasing rules when dereferencing the casted pointer,\ninvoking Undefined Behavior. The warning is there to prompt users to carefully\nanalyze whether the usage of \nreinterpret_cast\n is safe, in which case the\nwarning may be suppressed.\n\nExamples:\n\nusing\n \nIntegerPointer\n \n=\n \nint\n \n*\n;\n\n\ndouble\n \n*\nptr\n;\n\n\n\nstatic_cast\n<\nIntegerPointer\n>\n(\nstatic_cast\n<\nvoid\n \n*>\n(\nptr\n));\n \n// WRONG\n\n\nreinterpret_cast\n<\nIntegerPointer\n>\n(\nreinterpret_cast\n<\nvoid\n \n*>\n(\nptr\n));\n \n// WRONG\n\n\n(\nIntegerPointer\n)(\nvoid\n \n*\n)\nptr\n;\n \n// WRONG\n\n\nIntegerPointer\n(\nstatic_cast\n<\nvoid\n \n*>\n(\nptr\n));\n \n// WRONG\n\n\n\nreinterpret_cast\n<\nIntegerPointer\n>\n(\nptr\n);\n \n// OK, clearly expresses intent.\n\n\n                                       \n// NOTE: dereferencing this pointer violates\n\n\n                                       \n// the strict aliasing rules, invoking\n\n\n                                       \n// Undefined Behavior.",
    "configurations": []
  }
}