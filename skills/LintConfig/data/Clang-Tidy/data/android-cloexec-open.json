{
  "name": "android-cloexec-open",
  "meta": {
    "url": "https://clang.llvm.org/extra/clang-tidy/checks/android/cloexec-open.html",
    "fixable": true
  },
  "content": {
    "introduction": "A common source of security bugs is code that opens a file without using the\n\nO_CLOEXEC\n flag. Without that flag, an opened sensitive file would remain\nopen across a fork+exec to a lower-privileged SELinux domain, leaking that\nsensitive data. Open-like functions including \nopen()\n, \nopenat()\n, and\n\nopen64()\n should include \nO_CLOEXEC\n in their flags argument.\n\nExamples:\n\nopen\n(\n\"filename\"\n,\n \nO_RDWR\n);\n\n\nopen64\n(\n\"filename\"\n,\n \nO_RDWR\n);\n\n\nopenat\n(\n0\n,\n \n\"filename\"\n,\n \nO_RDWR\n);\n\n\n\n// becomes\n\n\n\nopen\n(\n\"filename\"\n,\n \nO_RDWR\n \n|\n \nO_CLOEXEC\n);\n\n\nopen64\n(\n\"filename\"\n,\n \nO_RDWR\n \n|\n \nO_CLOEXEC\n);\n\n\nopenat\n(\n0\n,\n \n\"filename\"\n,\n \nO_RDWR\n \n|\n \nO_CLOEXEC\n);",
    "configurations": []
  }
}