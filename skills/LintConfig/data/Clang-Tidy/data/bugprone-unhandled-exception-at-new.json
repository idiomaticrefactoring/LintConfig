{
  "name": "bugprone-unhandled-exception-at-new",
  "meta": {
    "url": "https://clang.llvm.org/extra/clang-tidy/checks/bugprone/unhandled-exception-at-new.html",
    "fixable": false
  },
  "content": {
    "introduction": "Finds calls to \nnew\n with missing exception handler for \nstd::bad_alloc\n.\n\nCalls to \nnew\n may throw exceptions of type \nstd::bad_alloc\n that should\nbe handled. Alternatively, the nonthrowing form of \nnew\n can be\nused. The check verifies that the exception is handled in the function\nthat calls \nnew\n.\n\nIf a nonthrowing version is used or the exception is allowed to propagate out\nof the function no warning is generated.\n\nThe exception handler is checked if it catches a \nstd::bad_alloc\n or\n\nstd::exception\n exception type, or all exceptions (catch-all).\nThe check assumes that any user-defined \noperator\n \nnew\n is either\n\nnoexcept\n or may throw an exception of type \nstd::bad_alloc\n (or one\nderived from it). Other exception class types are not taken into account.\n\nint\n \n*\nf\n()\n \nnoexcept\n \n{\n\n\n  \nint\n \n*\np\n \n=\n \nnew\n \nint\n[\n1000\n];\n \n// warning: missing exception handler for allocation failure at 'new'\n\n\n  \n// ...\n\n\n  \nreturn\n \np\n;\n\n\n}\n\nint\n \n*\nf1\n()\n \n{\n \n// not 'noexcept'\n\n\n  \nint\n \n*\np\n \n=\n \nnew\n \nint\n[\n1000\n];\n \n// no warning: exception can be handled outside\n\n\n                          \n// of this function\n\n\n  \n// ...\n\n\n  \nreturn\n \np\n;\n\n\n}\n\n\n\nint\n \n*\nf2\n()\n \nnoexcept\n \n{\n\n\n  \ntry\n \n{\n\n\n    \nint\n \n*\np\n \n=\n \nnew\n \nint\n[\n1000\n];\n \n// no warning: exception is handled\n\n\n    \n// ...\n\n\n    \nreturn\n \np\n;\n\n\n  \n}\n \ncatch\n \n(\nstd\n::\nbad_alloc\n \n&\n)\n \n{\n\n\n    \n// ...\n\n\n  \n}\n\n\n  \n// ...\n\n\n}\n\n\n\nint\n \n*\nf3\n()\n \nnoexcept\n \n{\n\n\n  \nint\n \n*\np\n \n=\n \nnew\n \n(\nstd\n::\nnothrow\n)\n \nint\n[\n1000\n];\n \n// no warning: \"nothrow\" is used\n\n\n  \n// ...\n\n\n  \nreturn\n \np\n;\n\n\n}",
    "configurations": []
  }
}