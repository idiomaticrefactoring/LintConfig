{
  "name": "android-cloexec-pipe2",
  "meta": {
    "url": "https://clang.llvm.org/extra/clang-tidy/checks/android/cloexec-pipe2.html",
    "fixable": true
  },
  "content": {
    "introduction": "This check ensures that \npipe2()\n is called with the \nO_CLOEXEC\n flag.\nThe check also adds the \nO_CLOEXEC\n flag that marks the file descriptor\nto be closed in child processes.\nWithout this flag a sensitive file descriptor can be leaked to a child process,\npotentially into a lower-privileged SELinux domain.\n\nExamples:\n\npipe2\n(\npipefd\n,\n \nO_NONBLOCK\n);\n\nSuggested replacement:\n\npipe2\n(\npipefd\n,\n \nO_NONBLOCK\n \n|\n \nO_CLOEXEC\n);",
    "configurations": []
  }
}