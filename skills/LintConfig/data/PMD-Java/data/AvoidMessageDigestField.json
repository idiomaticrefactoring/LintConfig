{
    "name": "AvoidMessageDigestField",
    "category": "bestpractices",
    "summary": "Declaring a MessageDigest instance as a field make this instance directly available to multiple threads.\nSuch sharing of MessageDigest instances should be avoided if possible since it leads to wrong results\nif the access is not synchronized correctly.\nJust create a new instance and use it locally, where you need it.\nCreating a new instance is easier than synchronizing access to a shared instance.",
    "message": "You shouldn't declare field of MessageDigest type, because unsynchronized access could cause problems",
    "url": "${pmd.website.baseurl}/pmd_rules_java_bestpractices.html#avoidmessagedigestfield",
    "since": "6.18.0",
    "priority": "3",
    "is_deprecated": false,
    "configuration": [],
    "examples": "import java.security.MessageDigest;\npublic class AvoidMessageDigestFieldExample {\nprivate final MessageDigest sharedMd;\npublic AvoidMessageDigestFieldExample() throws Exception {\nsharedMd = MessageDigest.getInstance(\"SHA-256\");\n}\npublic byte[] calculateHashShared(byte[] data) {\n// sharing a MessageDigest like this without synchronizing access\n// might lead to wrong results\nsharedMd.reset();\nsharedMd.update(data);\nreturn sharedMd.digest();\n}\n\n// better\npublic byte[] calculateHash(byte[] data) throws Exception {\nMessageDigest md = MessageDigest.getInstance(\"SHA-256\");\nmd.update(data);\nreturn md.digest();\n}\n}"
}